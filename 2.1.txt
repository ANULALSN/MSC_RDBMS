-- Create the database
CREATE DATABASE COMPANY;
USE COMPANY;

-- Create DEPARTMENT table
CREATE TABLE DEPARTMENT(
    DNAME VARCHAR(20) NOT NULL UNIQUE,
    DNUMBER INT PRIMARY KEY,
    MANAGERID INT,
    MGR_START_DATE DATE NOT NULL
);

-- Create EMPLOYEE table
CREATE TABLE EMPLOYEE (
    NAME VARCHAR(20) NOT NULL,
    EMPLOYEEID INT PRIMARY KEY,
    BIRTHDATE DATE,
    HOUSENAME VARCHAR(20),
    GENDER CHAR(1),
    SALARY DECIMAL(10,2) CHECK(SALARY BETWEEN 5000 AND 25000),
    SUPER_EID INT,
    DNUMBER INT,
    FOREIGN KEY (SUPER_EID) REFERENCES EMPLOYEE(EMPLOYEEID),
    FOREIGN KEY (DNUMBER) REFERENCES DEPARTMENT(DNUMBER)
);

-- Create remaining tables
CREATE TABLE DEPTLOCATIONS(
    DNUMBER INT,
    DLOCATION VARCHAR(50),
    PRIMARY KEY(DNUMBER, DLOCATION),
    FOREIGN KEY (DNUMBER) REFERENCES DEPARTMENT(DNUMBER)
);

CREATE TABLE PROJECT(
    PNAME VARCHAR(20) NOT NULL,
    PNUMBER INT PRIMARY KEY,
    PLOCATION VARCHAR(20),
    DNUMBER INT NOT NULL,
    FOREIGN KEY (DNUMBER) REFERENCES DEPARTMENT(DNUMBER)
);

CREATE TABLE WORKS_ON(
    EMPLOYEEID INT,
    PNUMBER INT,
    HOURS INT NOT NULL,
    PRIMARY KEY(EMPLOYEEID, PNUMBER),
    FOREIGN KEY (EMPLOYEEID) REFERENCES EMPLOYEE(EMPLOYEEID),
    FOREIGN KEY (PNUMBER) REFERENCES PROJECT(PNUMBER)
);